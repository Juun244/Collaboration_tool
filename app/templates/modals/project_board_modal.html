<!-- Project Board Modal -->
<script>
window.currentUser = {
  id: "{{ current_user.get_id() }}",
  username: "{{ current_user.username }}"
};
</script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<div class="modal fade" id="projectBoardModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="projectBoardTitle">프로젝트 보드</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <button class="btn btn-secondary mb-3" id="backToAllProjects" style="display: none;">
          <i class="bi bi-arrow-left"></i> Back to All Projects
        </button>
        <div class="kanban-board">
          <!-- 단일 카드 컨테이너 -->
          <div class="card-container mb-4"></div>

          <!-- 히스토리 섹션 -->
          <div id="history-section">
            <h3 id="history-toggle" style="cursor: pointer;">
              <i id="history-arrow" class="bi bi-caret-right-fill me-1"></i> 히스토리
            </h3>
            <div id="history-loading" style="display: none;">로딩 중...</div>
            <ul id="history-list"></ul>
          </div>

          <!-- 댓글 섹션 -->
          <div class="comment-section mt-5">
            <h4>댓글</h4>
            <div id="comment-list"></div>
            <div class="comment-input mt-3 d-flex">
              <textarea id="new-comment-content" class="form-control me-2" rows="2" placeholder="댓글을 입력하세요"></textarea>
              <button id="add-comment-btn" class="btn btn-primary">등록</button>
            </div>
          </div>
        </div>
      </div>

      <!-- ✅ JS에서 제어할 삭제/나가기 버튼 모두 넣기 -->
      <div class="modal-footer d-flex justify-content-between">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
        <button id="modalDeleteBtn" class="btn btn-danger delete-project d-none" data-project-id="">
          <i class="bi bi-trash"></i> 삭제
        </button>
        <button id="modalLeaveBtn" class="btn btn-outline-secondary leave-project d-none" data-project-id="">
          <i class="bi bi-box-arrow-left"></i> 나가기
        </button>
      </div>
    </div>
  </div>
</div>
